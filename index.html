<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nuestro √Ålbum Compartido - Vista Especial</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;800&family=Cormorant+Garamond:wght@400;500&family=Poppins:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Cormorant Garamond', serif;
            background: linear-gradient(135deg, #fce4ec 0%, #f3e5f5 50%, #fce4ec 100%);
            min-height: 100vh;
            color: #5a3a5a;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* RELOJ DE CORAZ√ìN UNIVERSAL */
        .heart-clock-container {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 600;
        }

        .heart-clock {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, #ff6b9d 0%, #ff1493 100%);
            border-radius: 50% 50% 50% 0;
            transform: rotate(-45deg);
            position: relative;
            box-shadow: 0 10px 30px rgba(255, 20, 147, 0.4);
            display: flex;
            justify-content: center;
            align-items: center;
            animation: heartbeatClock 1.5s ease-in-out infinite;
        }

        .clock-face {
            width: 85px;
            height: 85px;
            background: white;
            border-radius: 50%;
            transform: rotate(45deg);
            position: relative;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .clock-center {
            width: 10px;
            height: 10px;
            background: #ff1493;
            border-radius: 50%;
            position: absolute;
            z-index: 10;
        }

        .hand {
            position: absolute;
            bottom: 50%;
            left: 50%;
            transform-origin: bottom center;
            border-radius: 10px;
        }

        .hour-hand {
            width: 5px;
            height: 20px;
            background: #ff1493;
            margin-left: -2.5px;
        }

        .minute-hand {
            width: 3px;
            height: 28px;
            background: #ff6b9d;
            margin-left: -1.5px;
        }

        .second-hand {
            width: 2px;
            height: 28px;
            background: #ffb6d9;
            margin-left: -1px;
        }

        @keyframes heartbeatClock {
            0%, 100% {
                transform: rotate(-45deg) scale(1);
            }
            14% {
                transform: rotate(-45deg) scale(1.08);
            }
            28% {
                transform: rotate(-45deg) scale(1);
            }
        }

        /* CONTADOR DE ROSAS UNIVERSAL */
        .roses-counter {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(15px);
            padding: 18px 20px;
            border-radius: 20px;
            text-align: center;
            border: 2px solid #f48fb1;
            z-index: 600;
            box-shadow: 0 15px 40px rgba(193, 24, 91, 0.25);
            animation: slideInRight 0.8s ease-out;
            max-width: 240px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .roses-counter:hover {
            transform: scale(1.05);
            box-shadow: 0 20px 50px rgba(193, 24, 91, 0.35);
            border-color: #ec407a;
        }

        .roses-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.1em;
            color: #c2185b;
            margin-bottom: 10px;
            font-weight: 700;
            letter-spacing: 1px;
        }

        .roses-container {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            justify-content: center;
            max-height: 110px;
            overflow-y: auto;
            padding: 8px;
            background: linear-gradient(135deg, rgba(255, 182, 217, 0.1) 0%, rgba(243, 229, 245, 0.1) 100%);
            border-radius: 12px;
            margin-bottom: 10px;
        }

        .rose {
            font-size: 1.25em;
            animation: roseAppear 0.5s ease-out;
            transition: all 0.3s ease;
            cursor: pointer;
            filter: drop-shadow(0 2px 3px rgba(255, 105, 180, 0.3));
        }

        .rose:hover {
            transform: scale(1.3) rotate(15deg);
            filter: drop-shadow(0 4px 8px rgba(255, 20, 147, 0.5));
        }

        @keyframes roseAppear {
            0% {
                opacity: 0;
                transform: scale(0) rotate(-180deg);
            }
            50% {
                transform: scale(1.2);
            }
            100% {
                opacity: 1;
                transform: scale(1) rotate(0deg);
            }
        }

        .roses-message {
            font-size: 0.8em;
            color: #c2185b;
            margin-bottom: 8px;
            font-style: italic;
            font-weight: 600;
            letter-spacing: 0.5px;
            line-height: 1.4;
        }

        .roses-details {
            font-size: 0.75em;
            color: #8e3b5c;
            padding-top: 8px;
            border-top: 1px solid rgba(244, 143, 177, 0.3);
            display: none;
        }

        .roses-details.show {
            display: block;
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                max-height: 0;
            }
            to {
                opacity: 1;
                max-height: 200px;
            }
        }

        .rose-count {
            font-family: 'Playfair Display', serif;
            font-size: 1.3em;
            color: #c2185b;
            font-weight: 700;
            margin: 5px 0;
        }

        .rose-time {
            color: #ad1457;
            font-weight: 500;
        }

        .rose-progress {
            width: 100%;
            height: 4px;
            background: rgba(244, 143, 177, 0.2);
            border-radius: 10px;
            margin: 8px 0;
            overflow: hidden;
        }

        .rose-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #f48fb1 0%, #ec407a 100%);
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .roses-counter::-webkit-scrollbar {
            width: 4px;
        }

        .roses-counter::-webkit-scrollbar-track {
            background: rgba(244, 143, 177, 0.1);
            border-radius: 10px;
        }

        .roses-counter::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #f48fb1 0%, #ec407a 100%);
            border-radius: 10px;
        }

        /* ESTILOS DEL LOGIN */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .login-box {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 30px;
            padding: 60px 50px;
            box-shadow: 0 25px 80px rgba(193, 24, 91, 0.2);
            border: 2px solid rgba(193, 24, 91, 0.1);
            max-width: 450px;
            width: 100%;
            animation: slideUp 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .login-box h1 {
            font-family: 'Playfair Display', serif;
            font-size: 2.8em;
            color: #c2185b;
            text-align: center;
            margin-bottom: 15px;
            letter-spacing: 2px;
            text-shadow: 0 2px 4px rgba(193, 24, 91, 0.1);
        }

        .login-box .heart-icon {
            display: block;
            text-align: center;
            font-size: 2.5em;
            margin-bottom: 25px;
            animation: heartBeat 1.5s ease-in-out infinite;
        }

        .login-subtitle {
            text-align: center;
            color: #ad1457;
            margin-bottom: 40px;
            font-size: 1.1em;
            font-style: italic;
        }

        .login-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .login-form label {
            font-size: 1.05em;
            color: #5a3a5a;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .login-form input {
            padding: 14px 16px;
            border: 2px solid #f48fb1;
            border-radius: 12px;
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.05em;
            color: #5a3a5a;
            background: rgba(244, 143, 177, 0.05);
            transition: all 0.3s ease;
        }

        .login-form input:focus {
            outline: none;
            border-color: #c2185b;
            background: rgba(244, 143, 177, 0.1);
            box-shadow: 0 0 20px rgba(193, 24, 91, 0.2);
            transform: translateY(-2px);
        }

        .login-form input::placeholder {
            color: #b39ddb;
        }

        .login-btn {
            padding: 14px;
            background: linear-gradient(135deg, #c2185b 0%, #ad1457 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.15em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(193, 24, 91, 0.3);
            margin-top: 10px;
        }

        .login-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(193, 24, 91, 0.4);
        }

        .login-btn:active {
            transform: translateY(-1px);
        }

        .error-message {
            color: #f44336;
            text-align: center;
            font-size: 0.95em;
            display: none;
            padding: 12px;
            background: rgba(244, 67, 54, 0.1);
            border-radius: 10px;
            border-left: 4px solid #f44336;
            margin-bottom: 15px;
            animation: shake 0.5s ease-in-out;
        }

        .error-message.show {
            display: block;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        /* ESTILOS PRINCIPALES */
        .hidden {
            display: none !important;
        }

        .main-content {
            padding: 40px 20px 100px 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 50px;
            animation: fadeInDown 1s ease-out;
        }

        .header h1 {
            font-family: 'Playfair Display', serif;
            font-size: 3.2em;
            color: #c2185b;
            margin-bottom: 12px;
            letter-spacing: 2px;
            text-shadow: 0 2px 4px rgba(193, 24, 91, 0.1);
        }

        .header p {
            font-size: 1.3em;
            color: #ad1457;
            margin-bottom: 15px;
        }

        .user-info {
            background: linear-gradient(135deg, rgba(244, 143, 177, 0.2) 0%, rgba(243, 229, 245, 0.2) 100%);
            padding: 12px 28px;
            border-radius: 25px;
            display: inline-block;
            margin-bottom: 20px;
            border: 2px solid #f48fb1;
            font-size: 1.1em;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(193, 24, 91, 0.1);
        }

        .user-info span {
            font-weight: 600;
            color: #c2185b;
        }

        /* OPCIONES DE FORMATOS */
        .format-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 25px;
            margin-bottom: 50px;
            animation: fadeInUp 0.8s ease-out 0.2s both;
        }

        .format-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 25px;
            padding: 35px;
            text-align: center;
            border: 2px solid rgba(193, 24, 91, 0.1);
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            animation: fadeInUp 0.8s ease-out backwards;
            box-shadow: 0 10px 35px rgba(193, 24, 91, 0.12);
        }

        .format-card:nth-child(1) { animation-delay: 0.1s; }
        .format-card:nth-child(2) { animation-delay: 0.2s; }
        .format-card:nth-child(3) { animation-delay: 0.3s; }
        .format-card:nth-child(4) { animation-delay: 0.4s; }
        .format-card:nth-child(5) { animation-delay: 0.5s; }
        .format-card:nth-child(6) { animation-delay: 0.6s; }
        .format-card:nth-child(7) { animation-delay: 0.7s; }
        .format-card:nth-child(8) { animation-delay: 0.8s; }

        .format-card:hover {
            transform: translateY(-15px) scale(1.05);
            box-shadow: 0 25px 60px rgba(193, 24, 91, 0.25);
            border-color: #f48fb1;
        }

        .format-icon {
            font-size: 2.8em;
            margin-bottom: 12px;
        }

        .format-card h2 {
            font-family: 'Playfair Display', serif;
            font-size: 1.5em;
            color: #c2185b;
            margin-bottom: 10px;
        }

        .format-card p {
            font-size: 0.95em;
            color: #8e3b5c;
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .format-btn {
            padding: 11px 30px;
            background: linear-gradient(135deg, #c2185b 0%, #ad1457 100%);
            color: white;
            border: none;
            border-radius: 20px;
            font-family: 'Cormorant Garamond', serif;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 20px rgba(193, 24, 91, 0.3);
            font-weight: 600;
        }

        .format-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(193, 24, 91, 0.4);
        }

        /* BOT√ìN LOGOUT */
        .logout-btn {
            position: fixed;
            top: 130px;
            left: 20px;
            padding: 10px 20px;
            background: linear-gradient(135deg, #ec407a 0%, #c2185b 100%);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-family: 'Cormorant Garamond', serif;
            font-size: 0.95em;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(193, 24, 91, 0.3);
            z-index: 600;
            font-weight: 600;
        }

        .logout-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(193, 24, 91, 0.4);
        }

        /* VISTA P√öBLICA DEL √ÅLBUM */
        .public-header {
            text-align: center;
            margin-bottom: 40px;
            animation: fadeInDown 1s ease-out;
        }

        .public-header h1 {
            font-family: 'Playfair Display', serif;
            font-size: 3.2em;
            color: #c2185b;
            margin-bottom: 12px;
            letter-spacing: 2px;
        }

        .public-info {
            background: linear-gradient(135deg, rgba(244, 143, 177, 0.2) 0%, rgba(243, 229, 245, 0.2) 100%);
            padding: 15px 25px;
            border-radius: 20px;
            display: inline-block;
            margin-bottom: 20px;
            border: 2px solid #f48fb1;
            font-size: 1.05em;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(193, 24, 91, 0.1);
        }

        .public-info strong {
            color: #c2185b;
        }

        .public-menu {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
            animation: fadeInUp 0.8s ease-out;
        }

        .public-btn {
            padding: 15px;
            background: linear-gradient(135deg, #c2185b 0%, #ad1457 100%);
            color: white;
            border: none;
            border-radius: 15px;
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 20px rgba(193, 24, 91, 0.3);
            text-align: center;
        }

        .public-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(193, 24, 91, 0.4);
        }

        /* VISTAS DE FOTOS */
        .viewer-container {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 10px 40px rgba(193, 24, 91, 0.15);
            border: 1px solid rgba(193, 24, 91, 0.1);
            margin-bottom: 40px;
            animation: fadeInUp 0.8s ease-out;
        }

        .back-btn {
            display: inline-block;
            padding: 11px 25px;
            background: linear-gradient(135deg, #f48fb1 0%, #ec407a 100%);
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-family: 'Cormorant Garamond', serif;
            font-size: 0.95em;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(193, 24, 91, 0.3);
            margin-bottom: 30px;
            font-weight: 600;
        }

        .back-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(193, 24, 91, 0.4);
        }

        /* FORMULARIO DE CARGA */
        .upload-form {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(245, 229, 245, 0.95) 100%);
            border-radius: 25px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(193, 24, 91, 0.15);
            border: 2px solid rgba(193, 24, 91, 0.1);
        }

        .upload-form h2 {
            font-family: 'Playfair Display', serif;
            font-size: 2em;
            color: #c2185b;
            margin-bottom: 30px;
            text-align: center;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            font-size: 1.1em;
            color: #5a3a5a;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .form-group input[type="text"],
        .form-group input[type="date"],
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #f48fb1;
            border-radius: 12px;
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.05em;
            color: #5a3a5a;
            background: rgba(244, 143, 177, 0.05);
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #c2185b;
            background: rgba(244, 143, 177, 0.1);
            box-shadow: 0 0 20px rgba(193, 24, 91, 0.2);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
            font-family: 'Cormorant Garamond', serif;
        }

        .file-input-wrapper {
            position: relative;
            width: 100%;
        }

        .file-input-label {
            display: block;
            padding: 25px;
            background: linear-gradient(135deg, #c2185b 0%, #ad1457 100%);
            color: white;
            text-align: center;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1.05em;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(193, 24, 91, 0.3);
        }

        .file-input-label:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(193, 24, 91, 0.4);
        }

        #photoInput, #videoInput {
            display: none;
        }

        .submit-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #c2185b 0%, #ad1457 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.15em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(193, 24, 91, 0.3);
            margin-top: 20px;
        }

        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(193, 24, 91, 0.4);
        }

        .submit-btn:active {
            transform: translateY(-1px);
        }

        .message {
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 20px;
            font-size: 0.95em;
            display: none;
            animation: slideDown 0.3s ease-out;
        }

        .message.success {
            background: rgba(76, 175, 80, 0.1);
            border-left: 4px solid #4CAF50;
            color: #4CAF50;
            display: block;
        }

        .message.error {
            background: rgba(244, 67, 54, 0.1);
            border-left: 4px solid #f44336;
            color: #f44336;
            display: block;
        }

        /* PREVISUALIZACI√ìN */
        .preview-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 30px;
            padding-top: 30px;
            border-top: 2px solid rgba(244, 143, 177, 0.2);
        }

        .preview-item {
            position: relative;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(193, 24, 91, 0.15);
            transition: all 0.3s ease;
            animation: zoomIn 0.5s ease-out;
        }

        .preview-item:hover {
            transform: scale(1.08);
            box-shadow: 0 10px 25px rgba(193, 24, 91, 0.25);
        }

        .preview-item img,
        .preview-item video {
            width: 100%;
            height: 150px;
            object-fit: cover;
            display: block;
        }

        .preview-delete {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(244, 67, 54, 0.9);
            color: white;
            border: none;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.1em;
            transition: all 0.2s ease;
            font-weight: bold;
        }

        .preview-delete:hover {
            background: rgba(244, 67, 54, 1);
            transform: scale(1.1);
        }

        .preview-info {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
            color: white;
            padding: 8px;
            font-size: 0.8em;
            text-align: center;
        }

        @keyframes zoomIn {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* MODAL DE COMPARTIR */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            animation: fadeIn 0.3s ease-out;
        }

        .modal.show {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            position: relative;
            background: white;
            padding: 40px;
            border-radius: 20px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .modal-header h2 {
            font-family: 'Playfair Display', serif;
            font-size: 2em;
            color: #c2185b;
            margin-bottom: 10px;
        }

        .modal-header p {
            color: #8e3b5c;
            font-size: 0.95em;
        }

        .share-url {
            background: rgba(244, 143, 177, 0.1);
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 20px;
            border: 2px solid #f48fb1;
        }

        .share-url input {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-family: 'Poppins', sans-serif;
            font-size: 0.9em;
            background: white;
            color: #5a3a5a;
            margin-bottom: 10px;
        }

        .copy-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-family: 'Cormorant Garamond', serif;
            font-size: 1em;
        }

        .copy-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.3);
        }

        .copy-btn.copied {
            background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            background: linear-gradient(135deg, #ec407a 0%, #c2185b 100%);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.5em;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .close-modal:hover {
            transform: scale(1.1);
        }

        .tabs-upload {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .tab-link {
            padding: 12px 25px;
            background: rgba(244, 143, 177, 0.2);
            border: 2px solid #f48fb1;
            border-radius: 20px;
            cursor: pointer;
            font-family: 'Cormorant Garamond', serif;
            font-size: 1em;
            color: #5a3a5a;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .tab-link.active {
            background: linear-gradient(135deg, #f48fb1 0%, #ec407a 100%);
            color: white;
            border-color: #c2185b;
        }

        .tab-link:hover {
            background: rgba(244, 143, 177, 0.3);
        }

        .tab-content-upload {
            display: none;
        }

        .tab-content-upload.active {
            display: block;
        }

        .carousel {
            position: relative;
            width: 100%;
            height: 500px;
            border-radius: 20px;
            overflow: hidden;
            background: linear-gradient(135deg, #fce4ec 0%, #f3e5f5 100%);
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
        }

        .carousel-slide {
            position: absolute;
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: opacity 0.8s ease-in-out;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 40px;
        }

        .carousel-slide.active {
            opacity: 1;
        }

        .carousel-slide img,
        .carousel-slide video {
            max-width: 100%;
            max-height: 100%;
            border-radius: 15px;
            object-fit: contain;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
        }

        .carousel-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .carousel-btn {
            padding: 10px 25px;
            background: linear-gradient(135deg, #f48fb1 0%, #ec407a 100%);
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-family: 'Cormorant Garamond', serif;
            font-size: 0.95em;
            transition: all 0.3s ease;
            box-shadow: 0 5px 12px rgba(193, 24, 91, 0.3);
            font-weight: 600;
        }

        .carousel-btn:hover {
            transform: translateY(-2px);
        }

        .carousel-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .slide-counter {
            font-size: 1em;
            color: #c2185b;
            font-weight: 600;
            min-width: 80px;
            text-align: center;
        }

        .slide-info {
            text-align: center;
            padding: 20px;
            background: rgba(244, 143, 177, 0.05);
            border-radius: 15px;
            margin-top: 20px;
            border: 1px solid rgba(244, 143, 177, 0.2);
        }

        .slide-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.6em;
            color: #c2185b;
            margin-bottom: 8px;
        }

        .slide-date {
            font-size: 0.95em;
            color: #8e3b5c;
            margin-bottom: 10px;
        }

        .slide-message {
            font-size: 1.05em;
            color: #5a3a5a;
            font-style: italic;
            line-height: 1.6;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .grid-item {
            background: white;
            border-radius: 18px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(193, 24, 91, 0.15);
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            cursor: pointer;
            animation: fadeIn 0.6s ease-out backwards;
        }

        .grid-item:hover {
            transform: translateY(-12px) scale(1.05);
            box-shadow: 0 20px 50px rgba(193, 24, 91, 0.25);
        }

        .grid-image {
            width: 100%;
            height: 250px;
            object-fit: cover;
        }

        .grid-info {
            padding: 18px;
            background: white;
        }

        .grid-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.15em;
            color: #c2185b;
            margin-bottom: 6px;
        }

        .grid-date {
            font-size: 0.85em;
            color: #8e3b5c;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #ad1457;
            grid-column: 1 / -1;
        }

        .empty-state h3 {
            font-family: 'Playfair Display', serif;
            font-size: 2.2em;
            margin-bottom: 15px;
        }

        .empty-state p {
            font-size: 1.1em;
            opacity: 0.8;
        }

        /* SECCI√ìN DE M√öSICA */
        .music-section {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(245, 229, 245, 0.95) 100%);
            border-radius: 25px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(193, 24, 91, 0.15);
            border: 2px solid rgba(193, 24, 91, 0.1);
        }

        .music-section h2 {
            font-family: 'Playfair Display', serif;
            font-size: 2em;
            color: #c2185b;
            margin-bottom: 30px;
            text-align: center;
        }

        .music-input-group {
            margin-bottom: 25px;
        }

        .music-input-group label {
            display: block;
            font-size: 1.1em;
            color: #5a3a5a;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .music-input-group input {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #f48fb1;
            border-radius: 12px;
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.05em;
            color: #5a3a5a;
            background: rgba(244, 143, 177, 0.05);
            transition: all 0.3s ease;
        }

        .music-input-group input:focus {
            outline: none;
            border-color: #c2185b;
            background: rgba(244, 143, 177, 0.1);
            box-shadow: 0 0 20px rgba(193, 24, 91, 0.2);
        }

        .music-help {
            background: rgba(76, 175, 80, 0.1);
            padding: 15px;
            border-radius: 12px;
            border-left: 4px solid #4CAF50;
            margin-bottom: 25px;
            font-size: 0.95em;
            color: #5a3a5a;
            line-height: 1.6;
        }

        .music-help strong {
            color: #4CAF50;
        }

        .music-preview {
            background: rgba(244, 143, 177, 0.1);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            border: 2px solid #f48fb1;
        }

        .music-preview h3 {
            font-family: 'Playfair Display', serif;
            color: #c2185b;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .music-player {
            width: 100%;
            height: 50px;
            margin-bottom: 15px;
        }

        .music-controls {
            display: flex;
            gap: 10px;
        }

        .music-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-family: 'Cormorant Garamond', serif;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .music-save-btn {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.3);
        }

        .music-save-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(76, 175, 80, 0.4);
        }

        .music-clear-btn {
            background: linear-gradient(135deg, #f48fb1 0%, #ec407a 100%);
            color: white;
            box-shadow: 0 5px 15px rgba(193, 24, 91, 0.3);
        }

        .music-clear-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(193, 24, 91, 0.4);
        }

        .music-volume-control {
            margin-bottom: 15px;
        }

        .music-volume-control label {
            display: block;
            font-size: 1em;
            color: #5a3a5a;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .volume-slider {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: rgba(244, 143, 177, 0.2);
            outline: none;
            -webkit-appearance: none;
            cursor: pointer;
        }

        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: linear-gradient(135deg, #f48fb1 0%, #ec407a 100%);
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(193, 24, 91, 0.3);
        }

        .volume-slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: linear-gradient(135deg, #f48fb1 0%, #ec407a 100%);
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(193, 24, 91, 0.3);
            border: none;
        }

        .music-status {
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            font-weight: 600;
            margin-top: 15px;
        }

        .music-status.active {
            background: rgba(76, 175, 80, 0.1);
            color: #4CAF50;
            border: 1px solid #4CAF50;
        }

        .music-status.inactive {
            background: rgba(158, 158, 158, 0.1);
            color: #757575;
            border: 1px solid #9e9e9e;
        }

        .youtube-info {
            background: rgba(255, 193, 7, 0.1);
            padding: 12px;
            border-radius: 8px;
            margin-top: 10px;
            border-left: 4px solid #FFC107;
            font-size: 0.9em;
            color: #5a3a5a;
        }

        .footer {
            text-align: center;
            margin-top: 60px;
            padding-bottom: 30px;
            color: #ad1457;
            font-size: 0.95em;
            opacity: 0.8;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            to {
                opacity: 1;
            }
        }

        @keyframes heartBeat {
            0%, 100% {
                transform: scale(1);
            }
            14% {
                transform: scale(1.3);
            }
            28% {
                transform: scale(1);
            }
        }

        @media (max-width: 768px) {
            .login-box {
                padding: 40px 30px;
            }

            .login-box h1 {
                font-size: 2.2em;
            }

            .carousel {
                height: 350px;
            }

            .carousel-slide {
                padding: 20px;
            }

            .carousel-slide img,
            .carousel-slide video {
                max-height: 80%;
            }

            .grid-container {
                grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            }

            .format-options {
                grid-template-columns: repeat(2, 1fr);
            }

            .heart-clock-container {
                top: 10px;
                left: 10px;
            }

            .heart-clock {
                width: 80px;
                height: 80px;
            }

            .clock-face {
                width: 68px;
                height: 68px;
            }

            .roses-counter {
                bottom: 10px;
                right: 10px;
                max-width: 160px;
            }

            .logout-btn {
                top: 100px;
                left: 10px;
                padding: 8px 15px;
                font-size: 0.85em;
            }

            .main-content {
                padding: 30px 15px 80px 15px;
            }

            .header h1 {
                font-size: 2.2em;
            }

            .viewer-container {
                padding: 25px;
            }

            .preview-container {
                grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            }
        }

        @media (max-width: 480px) {
            .format-options {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 1.8em;
            }

            .login-box {
                padding: 30px 20px;
                max-width: 100%;
            }

            .heart-clock {
                width: 70px;
                height: 70px;
            }

            .roses-counter {
                padding: 12px 15px;
                max-width: 150px;
            }

            .modal-content {
                width: 95%;
                padding: 30px 20px;
            }
        }
    </style>
</head>
<body>
    <!-- RELOJ DE CORAZ√ìN (SIEMPRE VISIBLE) -->
    <div class="heart-clock-container">
        <div class="heart-clock">
            <div class="clock-face">
                <div class="hand hour-hand" id="hourHand"></div>
                <div class="hand minute-hand" id="minuteHand"></div>
                <div class="hand second-hand" id="secondHand"></div>
                <div class="clock-center"></div>
            </div>
        </div>
    </div>

    <!-- CONTADOR DE ROSAS (SIEMPRE VISIBLE) -->
    <div class="roses-counter" id="rosesCounter" onclick="toggleRosesDetails()">
        <div class="roses-title">üåπ Rosas de Amor</div>
        <div class="roses-container" id="rosesContainer"></div>
        <div class="roses-message">Una rosa por cada mes juntos ‚ù§Ô∏è</div>
        <div class="roses-details" id="rosesDetails">
            <div class="rose-count" id="roseCount">29 Rosas</div>
            <div class="rose-time" id="roseTime">Desde el 14 de Febrero</div>
            <div class="rose-progress">
                <div class="rose-progress-bar" id="roseProgress"></div>
            </div>
            <div id="nextRoseDate" style="font-size: 0.7em; color: #ad1457; margin-top: 5px; font-weight: 500;">
                Pr√≥xima rosa en...
            </div>
        </div>
    </div>

    <!-- LOGIN -->
    <div id="loginContainer" class="login-container">
        <div class="login-box">
            <h1>üíï Nuestro Amor üíï</h1>
            <div class="heart-icon">üíó</div>
            <p class="login-subtitle">Galer√≠a Compartida Especial</p>

            <div class="error-message" id="errorMessage"></div>

            <form id="loginForm" onsubmit="login(event)">
                <div>
                    <label for="username">üë§ Usuario</label>
                    <input type="text" id="username" placeholder="Ingresa tu usuario" required autocomplete="off">
                </div>
                
                <div>
                    <label for="password">üîê Contrase√±a</label>
                    <input type="password" id="password" placeholder="Ingresa tu contrase√±a" required autocomplete="off">
                </div>
                
                <button type="submit" class="login-btn">üîì Ingresar</button>
            </form>
        </div>
    </div>

    <!-- APLICACI√ìN PRINCIPAL -->
    <div id="mainApp" class="hidden">
        <button class="logout-btn" onclick="logout()">üö™ Salir</button>

        <div class="main-content">
            <div class="container">
                <div class="header">
                    <h1>üåπ Nuestro √Ålbum Compartido üåπ</h1>
                    <div class="user-info">
                        Bienvenido <span id="userName">REY</span> üíï
                    </div>
                </div>

                <!-- MEN√ö PRINCIPAL -->
                <div id="mainMenu" class="format-options">
                    <div class="format-card">
                        <div class="format-icon">‚ûï</div>
                        <h2>Subir Contenido</h2>
                        <p>Carga tus fotos y videos especiales</p>
                        <button class="format-btn" onclick="showView('upload')">Subir</button>
                    </div>

                    <div class="format-card">
                        <div class="format-icon">üéµ</div>
                        <h2>M√∫sica de Fondo</h2>
                        <p>Agrega una canci√≥n para la presentaci√≥n</p>
                        <button class="format-btn" onclick="showView('music')">Configurar</button>
                    </div>

                    <div class="format-card">
                        <div class="format-icon">üé†</div>
                        <h2>Carrusel</h2>
                        <p>Disfruta nuestros momentos en una presentaci√≥n deslizante</p>
                        <button class="format-btn" onclick="showView('carousel')">Ver</button>
                    </div>

                    <div class="format-card">
                        <div class="format-icon">üìä</div>
                        <h2>Rejilla</h2>
                        <p>Galer√≠a ordenada y moderna</p>
                        <button class="format-btn" onclick="showView('grid')">Ver</button>
                    </div>

                    <div class="format-card">
                        <div class="format-icon">üîó</div>
                        <h2>√Ålbum P√∫blico</h2>
                        <p>Comparte tu √°lbum con una URL p√∫blica</p>
                        <button class="format-btn" onclick="showShareModal()">Compartir</button>
                    </div>
                </div>

                <!-- VISTA DE CARGA -->
                <div id="uploadView" class="hidden">
                    <div class="viewer-container">
                        <button class="back-btn" onclick="backToMenu()">‚Üê Volver al Men√∫</button>
                        
                        <div class="upload-form">
                            <h2>üì∏ Sube tu Contenido Especial</h2>
                            
                            <div class="tabs-upload">
                                <button class="tab-link active" onclick="switchUploadTab('photos')">üì∏ Fotos</button>
                                <button class="tab-link" onclick="switchUploadTab('videos')">üé• Videos</button>
                            </div>

                            <!-- TAB FOTOS -->
                            <div id="photos-tab" class="tab-content-upload active">
                                <form id="photoForm" onsubmit="uploadPhoto(event)">
                                    <div class="form-group">
                                        <label for="photoDate">üìÖ Fecha del Momento:</label>
                                        <input type="date" id="photoDate" required>
                                    </div>

                                    <div class="form-group">
                                        <label for="photoTitle">‚ú® T√≠tulo o Detalle:</label>
                                        <input type="text" id="photoTitle" placeholder="Ej: Nuestro primer beso, Cena especial..." required>
                                    </div>

                                    <div class="form-group">
                                        <label for="photoMessage">üíå Mensaje de Amor:</label>
                                        <textarea id="photoMessage" placeholder="Escribe un mensaje especial, palabra de cari√±o o recuerdo..."></textarea>
                                    </div>

                                    <div class="form-group">
                                        <label for="photoInput">üñºÔ∏è Selecciona tu Foto:</label>
                                        <div class="file-input-wrapper">
                                            <label for="photoInput" class="file-input-label">
                                                üì∏ Haz clic para elegir una foto
                                            </label>
                                            <input type="file" id="photoInput" accept="image/*" required>
                                        </div>
                                    </div>

                                    <div id="photoMessage" class="message"></div>
                                    <button type="submit" class="submit-btn">üíæ Guardar Foto</button>
                                </form>
                            </div>

                            <!-- TAB VIDEOS -->
                            <div id="videos-tab" class="tab-content-upload">
                                <form id="videoForm" onsubmit="uploadVideo(event)">
                                    <div class="form-group">
                                        <label for="videoDate">üìÖ Fecha del Video:</label>
                                        <input type="date" id="videoDate" required>
                                    </div>

                                    <div class="form-group">
                                        <label for="videoTitle">‚ú® T√≠tulo del Video:</label>
                                        <input type="text" id="videoTitle" placeholder="Ej: Nuestro viaje especial, Momentos juntos..." required>
                                    </div>

                                    <div class="form-group">
                                        <label for="videoMessage">üíå Descripci√≥n o Mensaje:</label>
                                        <textarea id="videoMessage" placeholder="Escribe una descripci√≥n o mensaje especial..."></textarea>
                                    </div>

                                    <div class="form-group">
                                        <label for="videoInput">üé• Selecciona tu Video:</label>
                                        <div class="file-input-wrapper">
                                            <label for="videoInput" class="file-input-label">
                                                üé¨ Haz clic para elegir un video (m√°x. 100MB)
                                            </label>
                                            <input type="file" id="videoInput" accept="video/*" required>
                                        </div>
                                    </div>

                                    <div id="videoMessage" class="message"></div>
                                    <button type="submit" class="submit-btn">üé¨ Guardar Video</button>
                                </form>
                            </div>
                        </div>

                        <div>
                            <h2 style="text-align: center; color: #c2185b; margin-top: 50px; margin-bottom: 30px; font-family: 'Playfair Display', serif; font-size: 1.8em;">
                                üì∑ Contenido Cargado
                            </h2>
                            <div class="preview-container" id="uploadedItems"></div>
                        </div>
                    </div>
                </div>

                <!-- VISTA DE M√öSICA -->
                <div id="musicView" class="hidden">
                    <div class="viewer-container">
                        <button class="back-btn" onclick="backToMenu()">‚Üê Volver al Men√∫</button>
                        
                        <div class="music-section">
                            <h2>üéµ M√∫sica de Fondo para la Presentaci√≥n</h2>
                            
                            <div class="music-help">
                                <strong>üì∫ ¬øC√≥mo agregar m√∫sica?</strong><br>
                                1. Abre un video en YouTube<br>
                                2. Copia la URL del navegador (ej: https://www.youtube.com/watch?v=...)<br>
                                3. P√©gala en el campo de abajo<br>
                                4. ¬°La m√∫sica sonar√° en tus presentaciones!
                            </div>

                            <div class="music-input-group">
                                <label for="musicUrl">üé¨ URL de YouTube:</label>
                                <input type="text" id="musicUrl" placeholder="https://www.youtube.com/watch?v=... o https://youtu.be/...">
                            </div>

                            <div class="music-volume-control">
                                <label>üîä Volumen: <span id="volumeDisplay">70</span>%</label>
                                <input type="range" id="volumeSlider" class="volume-slider" min="0" max="100" value="70" oninput="updateVolumeDisplay(this.value)">
                            </div>

                            <div class="music-preview">
                                <h3>üéß Vista Previa</h3>
                                <div id="musicEmbed"></div>
                                <div id="musicStatus" class="music-status inactive">
                                    üîá Sin m√∫sica configurada
                                </div>
                            </div>

                            <div class="music-controls">
                                <button class="music-btn music-save-btn" onclick="saveBackgroundMusic()">üíæ Guardar M√∫sica</button>
                                <button class="music-btn music-clear-btn" onclick="clearBackgroundMusic()">üóëÔ∏è Eliminar M√∫sica</button>
                            </div>

                            <div class="youtube-info">
                                üí° <strong>Consejo:</strong> Busca canciones sin copyright en YouTube Audio Library para evitar problemas legales.
                            </div>
                        </div>
                    </div>
                </div>

                <!-- VISTA CARRUSEL -->
                <div id="carouselView" class="hidden">
                    <div class="viewer-container">
                        <button class="back-btn" onclick="backToMenu()">‚Üê Volver al Men√∫</button>
                        <div class="carousel" id="carousel"></div>
                        <div class="carousel-controls">
                            <button class="carousel-btn" onclick="previousSlide()" id="prevBtn">‚Üê Anterior</button>
                            <span class="slide-counter"><span id="currentSlide">0</span> / <span id="totalSlides">0</span></span>
                            <button class="carousel-btn" onclick="nextSlide()" id="nextBtn">Siguiente ‚Üí</button>
                        </div>
                        <div class="slide-info" id="slideInfo"></div>
                    </div>
                </div>

                <!-- VISTA REJILLA -->
                <div id="gridView" class="hidden">
                    <div class="viewer-container">
                        <button class="back-btn" onclick="backToMenu()">‚Üê Volver al Men√∫</button>
                        <div class="grid-container" id="gridContainer"></div>
                    </div>
                </div>

                <!-- MODAL DE COMPARTIR -->
                <div id="shareModal" class="modal">
                    <div class="modal-content">
                        <button class="close-modal" onclick="closeShareModal()">&times;</button>
                        <div class="modal-header">
                            <h2>üîó Compartir √Ålbum</h2>
                            <p>Genera un enlace p√∫blico para compartir tu √°lbum</p>
                        </div>

                        <div class="share-url">
                            <input type="text" id="shareLink" readonly placeholder="Tu enlace p√∫blico">
                            <button class="copy-btn" onclick="copyShareLink()">üìã Copiar Enlace</button>
                        </div>

                        <div style="background: rgba(244, 143, 177, 0.1); padding: 15px; border-radius: 10px; margin-top: 20px; text-align: center;">
                            <p style="font-size: 0.9em; color: #5a3a5a; margin-bottom: 10px;">
                                ‚ú® Este enlace permite que otros vean tu √°lbum sin necesidad de contrase√±a
                            </p>
                            <button class="format-btn" onclick="openPublicAlbum()">üåê Ver como P√∫blico</button>
                        </div>
                    </div>
                </div>

                <div class="footer">
                    <p>
                        <span style="display: inline-block; animation: heartBeat 1.5s ease-in-out infinite;">‚ù§Ô∏è</span>
                        Hecho con amor para ustedes
                        <span style="display: inline-block; animation: heartBeat 1.5s ease-in-out infinite;">‚ù§Ô∏è</span>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // DATOS DE USUARIOS
        const users = {
            'REY': '44352621',
            'REINA': '45280747'
        };

        // FOTOS DE EJEMPLO
        const defaultPhotos = [
            {
                title: "Nuestro Primer Beso",
                date: "2024-02-14",
                message: "El momento m√°s especial de nuestras vidas...",
                image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Crect fill='%23FFB6D9' width='400' height='400'/%3E%3Ctext x='50%25' y='50%25' font-size='40' fill='%23c2185b' text-anchor='middle' dominant-baseline='central' font-family='serif' font-weight='bold'%3Eüíï Primer Beso üíï%3C/text%3E%3C/svg%3E",
                type: 'photo'
            }
        ];

        let currentUser = null;
        let currentSlide = 0;
        let photos = [];
        let backgroundMusic = null;
        let audioPlayer = null;

        // RESTAURAR SESI√ìN AL CARGAR
        function restoreSession() {
            const savedUser = sessionStorage.getItem('currentUser');
            const savedPhotos = localStorage.getItem('sharedPhotos');
            
            if (savedUser && savedPhotos) {
                currentUser = savedUser;
                photos = JSON.parse(savedPhotos);
                
                // Mostrar app, ocultar login
                document.getElementById('loginContainer').classList.add('hidden');
                document.getElementById('mainApp').classList.remove('hidden');
                document.getElementById('mainMenu').classList.remove('hidden');
                document.getElementById('userName').textContent = currentUser;
                
                console.log('‚úÖ Sesi√≥n restaurada para:', currentUser);
                return true;
            }
            return false;
        }

        // GUARDAR SESI√ìN ACTUAL
        function saveSession() {
            if (currentUser) {
                sessionStorage.setItem('currentUser', currentUser);
                localStorage.setItem('sharedPhotos', JSON.stringify(photos));
                savePhotosWithFolders();
                console.log('‚úÖ Sesi√≥n guardada');
            }
        }

        // Guardar sesi√≥n cada 5 segundos
        setInterval(saveSession, 5000);

        // Guardar sesi√≥n antes de cerrar/recargar
        window.addEventListener('beforeunload', saveSession);
        window.addEventListener('pagehide', saveSession);

        // RELOJ DE CORAZ√ìN
        function updateHeartClock() {
            const now = new Date();
            const seconds = now.getSeconds();
            const minutes = now.getMinutes();
            const hours = now.getHours() % 12;

            const secondDegrees = (seconds / 60) * 360;
            const minuteDegrees = (minutes / 60) * 360 + (seconds / 60) * 6;
            const hourDegrees = (hours / 12) * 360 + (minutes / 60) * 30;

            document.getElementById('secondHand').style.transform = `rotate(${secondDegrees}deg)`;
            document.getElementById('minuteHand').style.transform = `rotate(${minuteDegrees}deg)`;
            document.getElementById('hourHand').style.transform = `rotate(${hourDegrees}deg)`;
        }

        setInterval(updateHeartClock, 1000);
        updateHeartClock();

        // CONTADOR DE ROSAS
        const START_DATE = new Date('2024-02-14');
        const INITIAL_ROSES = 29;

        function calculateRoses() {
            const now = new Date();
            let months = (now.getFullYear() - START_DATE.getFullYear()) * 12;
            months += now.getMonth() - START_DATE.getMonth();
            if (now.getDate() < START_DATE.getDate()) {
                months--;
            }
            return Math.max(INITIAL_ROSES, INITIAL_ROSES + months);
        }

        function calculateNextRoseDate() {
            const now = new Date();
            let nextRose = new Date(START_DATE);
            const currentRoses = calculateRoses();
            const monthsToAdd = currentRoses - INITIAL_ROSES + 1;
            nextRose.setMonth(nextRose.getMonth() + monthsToAdd);

            const daysUntil = Math.ceil((nextRose - now) / (1000 * 60 * 60 * 24));
            return { date: nextRose, daysUntil: Math.max(0, daysUntil) };
        }

        function displayRoses() {
            const totalRoses = calculateRoses();
            const rosesContainer = document.getElementById('rosesContainer');
            rosesContainer.innerHTML = '';
            
            for (let i = 0; i < totalRoses; i++) {
                const rose = document.createElement('div');
                rose.className = 'rose';
                rose.textContent = 'üåπ';
                rose.style.animationDelay = `${i * 0.05}s`;
                rose.title = `Rosa ${i + 1}`;
                rosesContainer.appendChild(rose);
            }

            document.getElementById('roseCount').textContent = `${totalRoses} Rosas`;
            
            const monthsText = totalRoses - INITIAL_ROSES === 0 ? 'Inicio del viaje' : `${totalRoses - INITIAL_ROSES} meses juntos`;
            document.getElementById('roseTime').textContent = `${monthsText} üíï`;

            const nextRose = calculateNextRoseDate();
            if (nextRose.daysUntil === 0) {
                document.getElementById('nextRoseDate').textContent = '‚ú® ¬°Nueva rosa disponible hoy!';
                document.getElementById('nextRoseDate').style.color = '#4CAF50';
            } else {
                document.getElementById('nextRoseDate').textContent = `Faltan ${nextRose.daysUntil} d√≠as`;
            }

            const now = new Date();
            const dayOfMonth = now.getDate();
            const progressPercent = (dayOfMonth / 31) * 100;
            document.getElementById('roseProgress').style.width = progressPercent + '%';
        }

        function toggleRosesDetails() {
            const details = document.getElementById('rosesDetails');
            details.classList.toggle('show');
        }

        displayRoses();
        setInterval(displayRoses, 60000);

        // LOGIN
        function login(event) {
            event.preventDefault();
            
            const username = document.getElementById('username').value.toUpperCase().trim();
            const password = document.getElementById('password').value;
            const errorMsg = document.getElementById('errorMessage');

            errorMsg.classList.remove('show');

            if (!users[username]) {
                errorMsg.textContent = '‚ùå Usuario no encontrado';
                errorMsg.classList.add('show');
                document.getElementById('password').value = '';
                return;
            }

            if (users[username] !== password) {
                errorMsg.textContent = '‚ùå Contrase√±a incorrecta';
                errorMsg.classList.add('show');
                document.getElementById('password').value = '';
                return;
            }

            currentUser = username;
            document.getElementById('userName').textContent = username;
            loadPhotos();
            
            // GUARDAR SESI√ìN
            sessionStorage.setItem('currentUser', currentUser);
            localStorage.setItem('sharedPhotos', JSON.stringify(photos));
            
            document.getElementById('loginContainer').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
            document.getElementById('mainMenu').classList.remove('hidden');
            document.getElementById('loginForm').reset();
            
            console.log('‚úÖ Sesi√≥n iniciada y guardada para:', currentUser);
        }

        function logout() {
            if (confirm('¬øDeseas salir?')) {
                currentUser = null;
                currentSlide = 0;
                
                // LIMPIAR SESI√ìN
                sessionStorage.removeItem('currentUser');
                stopBackgroundMusic();
                
                document.getElementById('loginContainer').classList.remove('hidden');
                document.getElementById('mainApp').classList.add('hidden');
                document.getElementById('loginForm').reset();
                document.getElementById('username').focus();
                
                console.log('‚úÖ Sesi√≥n cerrada');
            }
        }

        // FOTOS
        function loadPhotos() {
            const stored = localStorage.getItem('sharedPhotos');
            if (stored) {
                try {
                    photos = JSON.parse(stored);
                } catch (e) {
                    console.error('Error parsing photos:', e);
                    photos = JSON.parse(JSON.stringify(defaultPhotos));
                }
            } else {
                photos = JSON.parse(JSON.stringify(defaultPhotos));
            }
            console.log('Fotos cargadas:', photos.length);
        }

        function createPhotoFolder(date) {
            // Crear carpeta con formato: YYYY-MM-DD
            const dateObj = new Date(date);
            const year = dateObj.getFullYear();
            const month = String(dateObj.getMonth() + 1).padStart(2, '0');
            const day = String(dateObj.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        function savePhotosWithFolders() {
            // Guardar fotos organizadas por fecha
            const photosByFolder = {};
            
            photos.forEach(photo => {
                const folder = createPhotoFolder(photo.date);
                if (!photosByFolder[folder]) {
                    photosByFolder[folder] = [];
                }
                photosByFolder[folder].push(photo);
            });

            // Guardar estructura en localStorage
            localStorage.setItem('sharedPhotos', JSON.stringify(photos));
            localStorage.setItem('photoFolders', JSON.stringify(photosByFolder));
            console.log('Fotos guardadas con carpetas:', Object.keys(photosByFolder));
        }

        function showView(view) {
            document.getElementById('mainMenu').classList.add('hidden');
            document.querySelectorAll('[id$="View"]').forEach(el => el.classList.add('hidden'));

            switch(view) {
                case 'upload':
                    displayUploadedItems();
                    const today = new Date().toISOString().split('T')[0];
                    document.getElementById('photoDate').value = today;
                    document.getElementById('videoDate').value = today;
                    document.getElementById('uploadView').classList.remove('hidden');
                    break;
                case 'music':
                    loadMusicSettings();
                    document.getElementById('musicView').classList.remove('hidden');
                    break;
                case 'carousel':
                    loadCarousel();
                    playBackgroundMusic();
                    document.getElementById('carouselView').classList.remove('hidden');
                    break;
                case 'grid':
                    loadGrid();
                    playBackgroundMusic();
                    document.getElementById('gridView').classList.remove('hidden');
                    break;
            }
        }

        function backToMenu() {
            document.getElementById('mainMenu').classList.remove('hidden');
            document.querySelectorAll('[id$="View"]').forEach(el => el.classList.add('hidden'));
            currentSlide = 0;
            stopBackgroundMusic();
        }

        // M√öSICA DE FONDO
        function extractYouTubeId(url) {
            // Extraer ID de YouTube de diferentes formatos
            let videoId = '';
            
            if (url.includes('youtube.com/watch?v=')) {
                videoId = url.split('v=')[1].split('&')[0];
            } else if (url.includes('youtu.be/')) {
                videoId = url.split('youtu.be/')[1].split('?')[0];
            } else if (url.includes('youtube.com/embed/')) {
                videoId = url.split('/embed/')[1].split('?')[0];
            }
            
            return videoId;
        }

        function loadMusicSettings() {
            const stored = localStorage.getItem('backgroundMusic');
            if (stored) {
                const music = JSON.parse(stored);
                document.getElementById('musicUrl').value = music.url;
                document.getElementById('volumeSlider').value = music.volume || 70;
                document.getElementById('volumeDisplay').textContent = music.volume || 70;
                updateMusicEmbed(music.url);
                updateMusicStatus(true, music.url);
            }
        }

        function updateMusicEmbed(url) {
            const embed = document.getElementById('musicEmbed');
            if (!url) {
                embed.innerHTML = '';
                return;
            }

            const videoId = extractYouTubeId(url);
            if (videoId) {
                embed.innerHTML = `
                    <iframe 
                        width="100%" 
                        height="300" 
                        src="https://www.youtube.com/embed/${videoId}" 
                        frameborder="0" 
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                        allowfullscreen 
                        style="border-radius: 10px;">
                    </iframe>
                `;
            } else {
                embed.innerHTML = '<p style="color: #f44336; text-align: center;">‚ùå URL de YouTube no v√°lida</p>';
            }
        }

        function updateMusicStatus(active, url = '') {
            const status = document.getElementById('musicStatus');
            if (active && url) {
                status.className = 'music-status active';
                status.innerHTML = 'üéµ ¬°M√∫sica configurada! Sonar√° en carrusel y rejilla';
            } else {
                status.className = 'music-status inactive';
                status.innerHTML = 'üîá Sin m√∫sica configurada';
            }
        }

        function updateVolumeDisplay(value) {
            document.getElementById('volumeDisplay').textContent = value;
        }

        function saveBackgroundMusic() {
            const url = document.getElementById('musicUrl').value.trim();
            const volume = document.getElementById('volumeSlider').value;

            if (!url) {
                alert('‚ùå Por favor ingresa una URL de YouTube');
                return;
            }

            const videoId = extractYouTubeId(url);
            if (!videoId) {
                alert('‚ùå URL de YouTube no v√°lida. Formatos v√°lidos:\n‚Ä¢ https://www.youtube.com/watch?v=...\n‚Ä¢ https://youtu.be/...');
                return;
            }

            const musicData = {
                url: url,
                videoId: videoId,
                volume: volume,
                savedDate: new Date().toISOString()
            };

            localStorage.setItem('backgroundMusic', JSON.stringify(musicData));
            backgroundMusic = musicData;

            updateMusicEmbed(url);
            updateMusicStatus(true, url);

            // Mostrar confirmaci√≥n
            const status = document.getElementById('musicStatus');
            const originalContent = status.innerHTML;
            status.innerHTML = '‚úÖ ¬°M√∫sica guardada exitosamente!';
            status.style.background = 'rgba(76, 175, 80, 0.2)';
            status.style.color = '#4CAF50';

            setTimeout(() => {
                status.innerHTML = originalContent;
                status.style.background = '';
                status.style.color = '';
                updateMusicStatus(true, url);
            }, 3000);
        }

        function clearBackgroundMusic() {
            if (confirm('¬øEst√°s seguro de que quieres eliminar la m√∫sica de fondo?')) {
                localStorage.removeItem('backgroundMusic');
                backgroundMusic = null;
                document.getElementById('musicUrl').value = '';
                document.getElementById('musicEmbed').innerHTML = '';
                updateMusicStatus(false);
                stopBackgroundMusic();

                const status = document.getElementById('musicStatus');
                const originalContent = status.innerHTML;
                status.innerHTML = '‚úÖ M√∫sica eliminada';
                status.style.background = 'rgba(255, 193, 7, 0.2)';
                status.style.color = '#FFC107';

                setTimeout(() => {
                    status.innerHTML = originalContent;
                    status.style.background = '';
                    status.style.color = '';
                    updateMusicStatus(false);
                }, 2000);
            }
        }

        function playBackgroundMusic() {
            const stored = localStorage.getItem('backgroundMusic');
            if (!stored) return;

            backgroundMusic = JSON.parse(stored);
            const videoId = backgroundMusic.videoId;

            // Detener audio anterior si existe
            if (audioPlayer) {
                audioPlayer.pause();
            }

            // Crear reproductor de audio con YouTube
            const audioUrl = `https://www.youtube.com/embed/${videoId}`;
            
            // Crear iframe oculto para reproducci√≥n
            let iframe = document.getElementById('hidden-audio-player');
            if (!iframe) {
                iframe = document.createElement('iframe');
                iframe.id = 'hidden-audio-player';
                iframe.style.display = 'none';
                iframe.allow = 'autoplay';
                document.body.appendChild(iframe);
            }

            iframe.src = `${audioUrl}?autoplay=1&controls=0&loop=1&playlist=${videoId}`;
        }

        function stopBackgroundMusic() {
            const iframe = document.getElementById('hidden-audio-player');
            if (iframe) {
                iframe.src = '';
            }
        }

        // CARGA DE FOTOS Y VIDEOS
        function switchUploadTab(tab) {
            document.querySelectorAll('.tab-content-upload').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.tab-link').forEach(el => el.classList.remove('active'));
            
            document.getElementById(tab + '-tab').classList.add('active');
            event.target.classList.add('active');
        }

        function uploadPhoto(event) {
            event.preventDefault();
            
            const file = document.getElementById('photoInput').files[0];
            if (!file) return;

            // Validar tama√±o
            if (file.size > 50 * 1024 * 1024) {
                showMessage('photoMessage', '‚ùå La foto es demasiado grande (m√°ximo 50MB)', 'error');
                return;
            }

            const reader = new FileReader();
            reader.onload = (e) => {
                const newPhoto = {
                    title: document.getElementById('photoTitle').value,
                    date: document.getElementById('photoDate').value,
                    message: document.getElementById('photoMessage').value,
                    image: e.target.result,
                    type: 'photo'
                };

                photos.push(newPhoto);
                savePhotos();
                displayUploadedItems();

                showMessage('photoMessage', '‚úÖ ¬°Foto guardada exitosamente!', 'success');
                document.getElementById('photoForm').reset();
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('photoDate').value = today;
            };

            reader.readAsDataURL(file);
        }

        function uploadVideo(event) {
            event.preventDefault();
            
            const file = document.getElementById('videoInput').files[0];
            if (!file) {
                showMessage('videoMessage', '‚ùå Por favor selecciona un video', 'error');
                return;
            }

            if (file.size > 100 * 1024 * 1024) {
                showMessage('videoMessage', '‚ùå El video es demasiado grande (m√°ximo 100MB)', 'error');
                return;
            }

            const reader = new FileReader();
            reader.onload = (e) => {
                const newVideo = {
                    title: document.getElementById('videoTitle').value,
                    date: document.getElementById('videoDate').value,
                    message: document.getElementById('videoMessage').value,
                    image: e.target.result,
                    type: 'video'
                };

                photos.push(newVideo);
                savePhotos();
                displayUploadedItems();

                showMessage('videoMessage', '‚úÖ ¬°Video guardado exitosamente!', 'success');
                document.getElementById('videoForm').reset();
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('videoDate').value = today;
            };

            reader.readAsDataURL(file);
        }

        function showMessage(elementId, text, type) {
            const messageDiv = document.getElementById(elementId);
            messageDiv.className = `message ${type}`;
            messageDiv.textContent = text;
            messageDiv.style.display = 'block';
            setTimeout(() => {
                messageDiv.style.display = 'none';
            }, 4000);
        }

        function displayUploadedItems() {
            const container = document.getElementById('uploadedItems');
            container.innerHTML = '';

            if (photos.length === 0) {
                container.innerHTML = '<div style="grid-column: 1/-1;"><div class="empty-state"><h3>Sin contenido a√∫n</h3><p>¬°Sube tus primeras fotos y videos! üíï</p></div></div>';
                return;
            }

            photos.forEach((photo, index) => {
                const item = document.createElement('div');
                item.className = 'preview-item';
                
                let mediaHTML = '';
                if (photo.type === 'video') {
                    mediaHTML = `<video src="${photo.image}" style="width: 100%; height: 150px; object-fit: cover;"></video>`;
                } else {
                    mediaHTML = `<img src="${photo.image}" alt="${photo.title}">`;
                }

                item.innerHTML = `
                    ${mediaHTML}
                    <div class="preview-info">
                        ${photo.type === 'video' ? 'üé•' : 'üì∏'} ${photo.title.substring(0, 15)}...
                    </div>
                    <button class="preview-delete" onclick="deleteItem(${index})" title="Eliminar">√ó</button>
                `;
                container.appendChild(item);
            });
        }

        function deleteItem(index) {
            if (confirm('¬øEst√°s seguro de que quieres eliminar este elemento?')) {
                photos.splice(index, 1);
                savePhotos();
                displayUploadedItems();
            }
        }

        function savePhotos() {
            localStorage.setItem('sharedPhotos', JSON.stringify(photos));
            savePhotosWithFolders(); // Tambi√©n crear estructura de carpetas
            console.log('Fotos guardadas. Total:', photos.length);
        }

        // CARRUSEL
        function loadCarousel() {
            const carousel = document.getElementById('carousel');
            carousel.innerHTML = '';
            currentSlide = 0;

            if (photos.length === 0) {
                carousel.innerHTML = '<div class="empty-state"><h3>Sin fotos</h3></div>';
                return;
            }

            photos.forEach((photo, index) => {
                const slide = document.createElement('div');
                slide.className = 'carousel-slide' + (index === 0 ? ' active' : '');
                if (photo.type === 'video') {
                    slide.innerHTML = `<video src="${photo.image}" controls style="max-width: 100%; max-height: 100%; border-radius: 15px;"></video>`;
                } else {
                    slide.innerHTML = `<img src="${photo.image}" alt="${photo.title}">`;
                }
                carousel.appendChild(slide);
            });

            updateCarousel();
        }

        function updateCarousel() {
            const slides = document.querySelectorAll('#carousel .carousel-slide');
            slides.forEach(s => s.classList.remove('active'));
            slides[currentSlide].classList.add('active');

            document.getElementById('prevBtn').disabled = currentSlide === 0;
            document.getElementById('nextBtn').disabled = currentSlide === slides.length - 1;
            document.getElementById('currentSlide').textContent = currentSlide + 1;
            document.getElementById('totalSlides').textContent = slides.length;

            const photo = photos[currentSlide];
            document.getElementById('slideInfo').innerHTML = `
                <div class="slide-title">${photo.title}</div>
                <div class="slide-date">${new Date(photo.date).toLocaleDateString('es-ES', {year: 'numeric', month: 'long', day: 'numeric'})}</div>
                <div class="slide-message">"${photo.message}"</div>
            `;
        }

        function nextSlide() {
            if (currentSlide < photos.length - 1) {
                currentSlide++;
                updateCarousel();
            }
        }

        function previousSlide() {
            if (currentSlide > 0) {
                currentSlide--;
                updateCarousel();
            }
        }

        // REJILLA
        function loadGrid() {
            const container = document.getElementById('gridContainer');
            container.innerHTML = '';

            if (photos.length === 0) {
                container.innerHTML = '<div class="empty-state" style="grid-column: 1/-1;"><h3>Sin fotos</h3></div>';
                return;
            }

            photos.forEach((photo, index) => {
                const item = document.createElement('div');
                item.className = 'grid-item';
                if (photo.type === 'video') {
                    item.innerHTML = `
                        <video src="${photo.image}" style="width: 100%; height: 250px; object-fit: cover;"></video>
                        <div class="grid-info">
                            <div class="grid-title">üé• ${photo.title}</div>
                            <div class="grid-date">${new Date(photo.date).toLocaleDateString('es-ES', {month: 'short', day: 'numeric'})}</div>
                        </div>
                    `;
                } else {
                    item.innerHTML = `
                        <img src="${photo.image}" alt="${photo.title}" class="grid-image">
                        <div class="grid-info">
                            <div class="grid-title">üì∏ ${photo.title}</div>
                            <div class="grid-date">${new Date(photo.date).toLocaleDateString('es-ES', {month: 'short', day: 'numeric'})}</div>
                        </div>
                    `;
                }
                container.appendChild(item);
            });
        }

        // COMPARTIR √ÅLBUM P√öBLICO
        function showShareModal() {
            const shareLink = generatePublicLink();
            document.getElementById('shareLink').value = shareLink;
            document.getElementById('shareModal').classList.add('show');
        }

        function closeShareModal() {
            document.getElementById('shareModal').classList.remove('show');
        }

        function generatePublicLink() {
            const baseUrl = window.location.origin + window.location.pathname;
            const publicId = btoa(currentUser + '_' + Date.now());
            localStorage.setItem('public_' + publicId, JSON.stringify({
                photos: photos,
                owner: currentUser,
                date: new Date().toISOString()
            }));
            return baseUrl + '?public=' + publicId;
        }

        function copyShareLink() {
            const shareLink = document.getElementById('shareLink');
            shareLink.select();
            document.execCommand('copy');
            
            const copyBtn = document.querySelector('.copy-btn');
            copyBtn.textContent = '‚úÖ ¬°Enlace Copiado!';
            copyBtn.classList.add('copied');
            
            setTimeout(() => {
                copyBtn.textContent = 'üìã Copiar Enlace';
                copyBtn.classList.remove('copied');
            }, 2000);
        }

        function openPublicAlbum() {
            const shareLink = document.getElementById('shareLink').value;
            window.open(shareLink, '_blank');
        }


        // INTENTAR RESTAURAR SESI√ìN AL RECARGAR
        const sessionRestored = restoreSession();

        // ===== VERIFICAR ACCESO P√öBLICO =====
        const urlParams = new URLSearchParams(window.location.search);
        const publicId = urlParams.get('public');

        if (publicId) {
            // Es acceso p√∫blico
            const publicData = localStorage.getItem('public_' + publicId);
            if (publicData) {
                try {
                    const albumData = JSON.parse(publicData);
                    photos = albumData.photos || [];
                    
                    document.getElementById('loginContainer').classList.add('hidden');
                    document.getElementById('mainApp').classList.add('hidden');
                    document.getElementById('publicAlbumContainer').classList.remove('hidden');
                    
                    updatePublicHeartClock();
                    displayPublicRoses();
                    setInterval(updatePublicHeartClock, 1000);
                    setInterval(displayPublicRoses, 60000);
                    
                    console.log('‚úÖ √Ålbum p√∫blico cargado:', photos.length, 'elementos');
                } catch (e) {
                    console.error('Error:', e);
                    alert('‚ùå √Ålbum no encontrado');
                }
            } else {
                alert('‚ùå Este √°lbum ya no est√° disponible');
            }
        }

        // ===== FUNCIONES DE VISTA P√öBLICA =====
        let publicCurrentSlide = 0;

        function updatePublicHeartClock() {
            const now = new Date();
            const seconds = now.getSeconds();
            const minutes = now.getMinutes();
            const hours = now.getHours() % 12;

            const secondDegrees = (seconds / 60) * 360;
            const minuteDegrees = (minutes / 60) * 360 + (seconds / 60) * 6;
            const hourDegrees = (hours / 12) * 360 + (minutes / 60) * 30;

            if (document.getElementById('publicSecondHand')) {
                document.getElementById('publicSecondHand').style.transform = `rotate(${secondDegrees}deg)`;
                document.getElementById('publicMinuteHand').style.transform = `rotate(${minuteDegrees}deg)`;
                document.getElementById('publicHourHand').style.transform = `rotate(${hourDegrees}deg)`;
            }
        }

        function displayPublicRoses() {
            const totalRoses = calculateRoses();
            const rosesContainer = document.getElementById('publicRosesContainer');
            if (!rosesContainer) return;
            
            rosesContainer.innerHTML = '';
            
            for (let i = 0; i < totalRoses; i++) {
                const rose = document.createElement('div');
                rose.className = 'rose';
                rose.textContent = 'üåπ';
                rose.style.animationDelay = `${i * 0.05}s`;
                rosesContainer.appendChild(rose);
            }

            document.getElementById('publicRoseCount').textContent = `${totalRoses} Rosas`;
            const monthsText = totalRoses - INITIAL_ROSES === 0 ? 'Inicio del viaje' : `${totalRoses - INITIAL_ROSES} meses juntos`;
            document.getElementById('publicRoseTime').textContent = `${monthsText} üíï`;

            const nextRose = calculateNextRoseDate();
            document.getElementById('publicNextRoseDate').textContent = nextRose.daysUntil === 0 ? 
                '‚ú® ¬°Nueva rosa hoy!' : `Faltan ${nextRose.daysUntil} d√≠as`;

            const now = new Date();
            const dayOfMonth = now.getDate();
            document.getElementById('publicRoseProgress').style.width = ((dayOfMonth / 31) * 100) + '%';
        }

        function togglePublicRosesDetails() {
            const details = document.getElementById('publicRosesDetails');
            if (details) details.classList.toggle('show');
        }

        function showPublicView(view) {
            document.getElementById('publicMenu').classList.add('hidden');
            document.querySelectorAll('[id^="public"][id$="View"]').forEach(el => el.classList.add('hidden'));

            if (view === 'carousel') {
                loadPublicCarousel();
                document.getElementById('publicCarouselView').classList.remove('hidden');
                playBackgroundMusic();
            } else if (view === 'grid') {
                loadPublicGrid();
                document.getElementById('publicGridView').classList.remove('hidden');
                playBackgroundMusic();
            }
        }

        function backToPublicMenu() {
            document.getElementById('publicMenu').classList.remove('hidden');
            document.querySelectorAll('[id^="public"][id$="View"]').forEach(el => el.classList.add('hidden'));
            publicCurrentSlide = 0;
            stopBackgroundMusic();
        }

        function loadPublicCarousel() {
            const carousel = document.getElementById('publicCarousel');
            carousel.innerHTML = '';
            publicCurrentSlide = 0;

            if (photos.length === 0) {
                carousel.innerHTML = '<div class="empty-state"><h3>Sin fotos</h3></div>';
                return;
            }

            photos.forEach((photo, index) => {
                const slide = document.createElement('div');
                slide.className = 'carousel-slide' + (index === 0 ? ' active' : '');
                if (photo.type === 'video') {
                    slide.innerHTML = `<video src="${photo.image}" controls style="max-width: 100%; max-height: 100%; border-radius: 15px;"></video>`;
                } else {
                    slide.innerHTML = `<img src="${photo.image}" alt="${photo.title}">`;
                }
                carousel.appendChild(slide);
            });

            updatePublicCarousel();
        }

        function updatePublicCarousel() {
            const slides = document.querySelectorAll('#publicCarousel .carousel-slide');
            slides.forEach(s => s.classList.remove('active'));
            if (slides[publicCurrentSlide]) slides[publicCurrentSlide].classList.add('active');

            document.getElementById('publicPrevBtn').disabled = publicCurrentSlide === 0;
            document.getElementById('publicNextBtn').disabled = publicCurrentSlide === slides.length - 1;
            document.getElementById('publicCurrentSlide').textContent = publicCurrentSlide + 1;
            document.getElementById('publicTotalSlides').textContent = slides.length;

            if (photos[publicCurrentSlide]) {
                const photo = photos[publicCurrentSlide];
                document.getElementById('publicSlideInfo').innerHTML = `
                    <div class="slide-title">${photo.title}</div>
                    <div class="slide-date">${new Date(photo.date).toLocaleDateString('es-ES', {year: 'numeric', month: 'long', day: 'numeric'})}</div>
                    <div class="slide-message">"${photo.message}"</div>
                `;
            }
        }

        function nextPublicSlide() {
            if (publicCurrentSlide < photos.length - 1) {
                publicCurrentSlide++;
                updatePublicCarousel();
            }
        }

        function previousPublicSlide() {
            if (publicCurrentSlide > 0) {
                publicCurrentSlide--;
                updatePublicCarousel();
            }
        }

        function loadPublicGrid() {
            const container = document.getElementById('publicGridContainer');
            container.innerHTML = '';

            if (photos.length === 0) {
                container.innerHTML = '<div class="empty-state"><h3>Sin fotos</h3></div>';
                return;
            }

            photos.forEach((photo, index) => {
                const item = document.createElement('div');
                item.className = 'grid-item';
                if (photo.type === 'video') {
                    item.innerHTML = `
                        <video src="${photo.image}" style="width: 100%; height: 250px; object-fit: cover;"></video>
                        <div class="grid-info">
                            <div class="grid-title">üé• ${photo.title}</div>
                            <div class="grid-date">${new Date(photo.date).toLocaleDateString('es-ES', {month: 'short', day: 'numeric'})}</div>
                        </div>
                    `;
                } else {
                    item.innerHTML = `
                        <img src="${photo.image}" alt="${photo.title}" class="grid-image">
                        <div class="grid-info">
                            <div class="grid-title">üì∏ ${photo.title}</div>
                            <div class="grid-date">${new Date(photo.date).toLocaleDateString('es-ES', {month: 'short', day: 'numeric'})}</div>
                        </div>
                    `;
                }
                container.appendChild(item);
            });
        }
        loadPhotos();
    </script>
</body>
</html>
